{"run_id":"1723535780-978255142","line":477,"new":{"module_name":"r#mod__middle__transform__mem2reg__tests_mem2reg","snapshot_name":"mem2reg_array","metadata":{"source":"tests/middle/transform/mem2reg.rs","assertion_line":477,"expression":"diff(&llvm_before, &llvm_after)"},"snapshot":"declare i32 @getint()\ndeclare i32 @getch()\ndeclare float @getfloat()\ndeclare void @putint(i32 %p0)\ndeclare void @putch(i32 %p0)\ndeclare void @putfloat(float %p0)\ndeclare i32 @getarray(i32* %p0)\ndeclare i32 @getfarray(float* %p0)\ndeclare void @putarray(i32 %p0, i32* %p1)\ndeclare void @putfarray(i32 %p0, float* %p1)\ndeclare void @_sysy_starttime(i32 %p0)\ndeclare void @_sysy_stoptime(i32 %p0)\ndeclare void @putf()\ndeclare void @llvm.memset.p0.i32(i32* %p0, i8 %p1, i32 %p2, i1 %p3)\ndefine i32 @main() {\nentry:\n%alloca_2 = alloca i32\n%alloca_5 = alloca [1 x i32]\ncall void @llvm.memset.p0.i32([1 x i32]* %alloca_5, i8 0, i32 4, i1 false)\n%getelementptr_7 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\nstore i32 8, ptr %getelementptr_7\n%getelementptr_9 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\n%call_10 = call i32 @f(i32* %getelementptr_9)\n%getelementptr_11 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\ncall void @putarray(i32 1, i32* %getelementptr_11)\n[-] store i32 0, ptr %alloca_2\nbr label %exit\n\nexit:\n[-] %load_3 = load i32, ptr %alloca_2\n[-] ret i32 %load_3\n[+] ret i32 0\n\n\n}\ndefine i32 @f(i32* %a) {\nentry:\n%alloca_17 = alloca i32\n%alloca_20 = alloca i32*\n[-] store i32* %a, ptr %alloca_20\n[-] %load_22 = load i32*, ptr %alloca_20\n[-] %getelementptr_23 = getelementptr i32, ptr %load_22, i32 0\n[+] %getelementptr_23 = getelementptr i32, ptr %a, i32 0\nstore i32 1, ptr %getelementptr_23\n[-] %load_25 = load i32*, ptr %alloca_20\n[-] %getelementptr_26 = getelementptr i32, ptr %load_25, i32 0\n[+] %getelementptr_26 = getelementptr i32, ptr %a, i32 0\n%load_27 = load i32, ptr %getelementptr_26\n[-] store i32 %load_27, ptr %alloca_17\nbr label %exit\n\nexit:\n[-] %load_18 = load i32, ptr %alloca_17\n[-] ret i32 %load_18\n[+] ret i32 %load_27\n\n\n}\n"},"old":{"module_name":"r#mod__middle__transform__mem2reg__tests_mem2reg","metadata":{},"snapshot":"declare i32 @getint()\ndeclare i32 @getch()\ndeclare float @getfloat()\ndeclare void @putint(i32 %p0)\ndeclare void @putch(i32 %p0)\ndeclare void @putfloat(float %p0)\ndeclare i32 @getarray(i32* %p0)\ndeclare i32 @getfarray(float* %p0)\ndeclare void @putarray(i32 %p0, i32* %p1)\ndeclare void @putfarray(i32 %p0, float* %p1)\ndeclare void @_sysy_starttime(i32 %p0)\ndeclare void @_sysy_stoptime(i32 %p0)\ndeclare void @putf()\ndeclare void @llvm.memset.p0.i32(i32* %p0, i8 %p1, i32 %p2, i1 %p3)\ndefine i32 @main() {\nentry:\n%alloca_2 = alloca i32\n%alloca_5 = alloca [1 x i32]\ncall void @llvm.memset.p0.i32([1 x i32]* %alloca_5, i8 0, i32 4, i1 false)\n%getelementptr_7 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\n%getelementptr_8 = getelementptr i32, ptr %getelementptr_7, i32 0\nstore i32 8, ptr %getelementptr_8\n%getelementptr_10 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\n%call_11 = call i32 @f(i32* %getelementptr_10)\n%getelementptr_12 = getelementptr [1 x i32], ptr %alloca_5, i32 0, i32 0\ncall void @putarray(i32 1, i32* %getelementptr_12)\n[-] store i32 0, ptr %alloca_2\nbr label %exit\n\nexit:\n[-] %load_3 = load i32, ptr %alloca_2\n[-] ret i32 %load_3\n[+] ret i32 0\n\n\n}\ndefine i32 @f(i32* %a) {\nentry:\n%alloca_18 = alloca i32\n%alloca_21 = alloca i32*\n[-] store i32* %a, ptr %alloca_21\n[-] %load_23 = load i32*, ptr %alloca_21\n[-] %getelementptr_24 = getelementptr i32, ptr %load_23, i32 0\n[+] %getelementptr_24 = getelementptr i32, ptr %a, i32 0\nstore i32 1, ptr %getelementptr_24\n[-] %load_26 = load i32*, ptr %alloca_21\n[-] %getelementptr_27 = getelementptr i32, ptr %load_26, i32 0\n[+] %getelementptr_27 = getelementptr i32, ptr %a, i32 0\n%load_28 = load i32, ptr %getelementptr_27\n[-] store i32 %load_28, ptr %alloca_18\nbr label %exit\n\nexit:\n[-] %load_19 = load i32, ptr %alloca_18\n[-] ret i32 %load_19\n[+] ret i32 %load_28\n\n\n}"}}
